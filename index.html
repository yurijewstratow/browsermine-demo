<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Browser Mining Demo</title>
  <style>
    body {
      background: #0d1117;
      color: #e6edf3;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    /* –ú–µ–Ω—é –∑–≤–µ—Ä—Ö—É */
    .tab-menu {
      display: flex;
      justify-content: center;
      background-color: #161b22;
      padding: 10px 0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .tab-menu button {
      background: none;
      border: none;
      color: #e6edf3;
      padding: 10px 20px;
      cursor: pointer;
      font-size: 1em;
      transition: 0.2s;
    }
    .tab-menu button:hover {
      background-color: #238636;
      border-radius: 8px;
    }
    .tab-menu button.active {
      background-color: #58a6ff;
      border-radius: 8px;
      color: #0d1117;
    }

    /* –°–µ–∫—Ü—ñ—ó –≤–∫–ª–∞–¥–æ–∫ */
    .tab-content {
      display: none;
      max-width: 600px;
      margin: 30px auto;
      padding: 20px;
      background: #161b22;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .tab-content.active {
      display: block;
    }

    /* –°—Ç–∏–ª—ñ –∫–∞—Ä—Ç–∫–∏ –º–∞–π–Ω—ñ–Ω–≥—É */
    #mainSection button {
      background: #238636;
      border: none;
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 1em;
      cursor: pointer;
      transition: 0.2s;
      margin: 5px;
    }
    #mainSection button:hover {
      background: #2ea043;
    }
    #mainSection button.stop {
      background: #da3633;
    }
    #mainSection button.stop:hover {
      background: #f85149;
    }
    #balance {
      font-size: 1.5em;
      margin: 15px 0;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <!-- –ú–µ–Ω—é –≤–∫–ª–∞–¥–æ–∫ -->
  <div class="tab-menu">
    <button class="tab-link active" data-tab="mainSection">–ì–æ–ª–æ–≤–Ω–∞</button>
    <button class="tab-link" data-tab="aboutSection">–û –Ω–∞—Å</button>
  </div>

  <!-- –í–∫–ª–∞–¥–∫–∞ –ì–æ–ª–æ–≤–Ω–∞ -->
  <div id="mainSection" class="tab-content active">
    <h1 style="text-align:center; color:#58a6ff;">üåê Browser Mining</h1>
    <p id="userInfo">–í–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ</p>
    <div id="balance">–ë–∞–ª–∞–Ω—Å: 0.000000 BMC</div>
    <div style="text-align:center;">
      <button id="authBtn">üîë –£–≤—ñ–π—Ç–∏ —á–µ—Ä–µ–∑ BrowserMine</button>
      <button id="toggleBtn">‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –º–∞–π–Ω—ñ–Ω–≥</button>
      <button id="switchBtn">üîÑ –ó–º—ñ–Ω–∏—Ç–∏ –∞–∫–∞—É–Ω—Ç</button>
    </div>
  </div>

  <!-- –í–∫–ª–∞–¥–∫–∞ –û –Ω–∞—Å -->
  <div id="aboutSection" class="tab-content">
    <h2 style="text-align:center; color:#58a6ff;">–ü—Ä–æ —Å–∞–π—Ç Browser Mining Demo</h2>
    <p>
      –¶–µ–π –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î, —è–∫ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤–µ–±-—Å–∞–π—Ç –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–Ω–æ–≥–æ –º–∞–π–Ω—ñ–Ω–≥—É –∑ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—î—é BrowserMine.com.
      –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å –∞–≤—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ BrowserMine, –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å–≤—ñ–π –±–∞–ª–∞–Ω—Å, UID —Ç–∞ email,
      –∑–∞–ø—É—Å–∫–∞—Ç–∏ –º–∞–π–Ω—ñ–Ω–≥ –ø—Ä—è–º–æ –Ω–∞ —Å–∞–π—Ç—ñ —Ç–∞ –≤—ñ–¥—Å–ª—ñ–¥–∫–æ–≤—É–≤–∞—Ç–∏ –±–∞–ª–∞–Ω—Å —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ.
    </p>
    <p>
      –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª —Å–∞–π—Ç—É:
      <ul>
        <li>–°—Ç–∞—Ä—Ç/–°—Ç–æ–ø –º–∞–π–Ω—ñ–Ω–≥—É —á–µ—Ä–µ–∑ WebMiner SDK</li>
        <li>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ BrowserMine –±–µ–∑ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –Ω–∞ —Å–∞–π—Ç—ñ</li>
        <li>–û–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞–ª–∞–Ω—Å—É –∫–æ–∂–Ω—ñ 15 —Å–µ–∫—É–Ω–¥</li>
        <li>–ó–º—ñ–Ω–∞ –∞–∫–∞—É–Ω—Ç—É –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏</li>
      </ul>
    </p>
    <p>
      –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó: HTML5, CSS3, Vanilla JS, WebMiner SDK, BrowserMine API.
    </p>
  </div>

  <!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è WebMiner SDK -->
  <script src="https://webminer.pages.dev/SDK/webminer.js"></script>

  <script>
    // ===== –ú–µ–Ω—é –≤–∫–ª–∞–¥–æ–∫ =====
    const tabLinks = document.querySelectorAll(".tab-link");
    const tabContents = document.querySelectorAll(".tab-content");

    tabLinks.forEach(btn => {
      btn.addEventListener("click", () => {
        // –ê–∫—Ç–∏–≤–Ω–∞ –∫–Ω–æ–ø–∫–∞
        tabLinks.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        // –ü–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –≤–∫–ª–∞–¥–∫—É
        const tab = btn.getAttribute("data-tab");
        tabContents.forEach(content => {
          content.id === tab ? content.classList.add("active") : content.classList.remove("active");
        });
      });
    });

    // ===== –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –º–∞–π–Ω—ñ–Ω–≥—É =====
    const CLIENT_REF = "7161825";
    const REDIRECT_URI = "https://yurijewstratow.github.io/browsermine-demo/";
    let accessToken = null;
    let mining = false;

    const userInfoEl = document.getElementById("userInfo");
    const balanceEl = document.getElementById("balance");
    const authBtn = document.getElementById("authBtn");
    const toggleBtn = document.getElementById("toggleBtn");
    const switchBtn = document.getElementById("switchBtn");

    // ===== –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è =====
    function redirectToAuth() {
      const url = `https://api.browsermine.com/v1/auth?redirect_uri=${encodeURIComponent(REDIRECT_URI)}&scope=email,balanceview,affiliate,miningstats&lang=ru&ref=${CLIENT_REF}`;
      window.location.href = url;
    }
    authBtn.addEventListener("click", redirectToAuth);

    function getQueryParam(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }

    function updateUserBalance() {
      if (!accessToken) return;
      fetch(`https://api.browsermine.com/v1/me?access_token=${accessToken}`)
        .then(res => res.json())
        .then(data => {
          if (data.user) {
            balanceEl.innerHTML = `–ë–∞–ª–∞–Ω—Å: ${data.user.balance.BMC.balReal} BMC`;
          }
        })
        .catch(() => console.log("‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –±–∞–ª–∞–Ω—Å—É"));
    }

    // ===== –û–±—Ä–æ–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –ø—ñ—Å–ª—è —Ä–µ–¥—ñ—Ä–µ–∫—Ç—É =====
    const code = getQueryParam("code");
    if (code) {
      fetch(`https://api.browsermine.com/v1/token?code=${code}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}`)
        .then(res => res.json())
        .then(data => {
          if (data.access_token) {
            accessToken = data.access_token;
            userInfoEl.innerHTML = `üë§ ${data.user.name} (UID: ${data.user.uid})`;
            balanceEl.innerHTML = `–ë–∞–ª–∞–Ω—Å: ${data.user.balance.BMC.balReal} BMC`;
            setInterval(updateUserBalance, 15000);
          } else {
            userInfoEl.innerHTML = "‚ùå –ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó";
          }
        })
        .catch(() => {
          userInfoEl.innerHTML = "‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ";
        });
    }

    // ===== –ú–∞–π–Ω—ñ–Ω–≥ =====
    function startMining() {
      mining = true;
      toggleBtn.textContent = "‚è∏Ô∏è –ó—É–ø–∏–Ω–∏—Ç–∏ –º–∞–π–Ω—ñ–Ω–≥";
      toggleBtn.classList.add("stop");

      WEBMINER.config({ login: CLIENT_REF, pass: null });
      WEBMINER.power(70);
      WEBMINER.loadStored();

      WEBMINER.on('accepted', () => {
        console.log("‚úÖ New share –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ");
        updateUserBalance();
      });
    }

    function stopMining() {
      mining = false;
      toggleBtn.textContent = "‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –º–∞–π–Ω—ñ–Ω–≥";
      toggleBtn.classList.remove("stop");
      WEBMINER.reset();
    }

    toggleBtn.addEventListener("click", () => {
      if (mining) stopMining(); else startMining();
    });

    // ===== –ó–º—ñ–Ω–∏—Ç–∏ –∞–∫–∞—É–Ω—Ç =====
    switchBtn.addEventListener("click", () => {
      if (mining) stopMining();
      accessToken = null;
      userInfoEl.innerHTML = "–í–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ";
      balanceEl.innerHTML = "–ë–∞–ª–∞–Ω—Å: 0.000000 BMC";
      redirectToAuth();
    });
  </script>
</body>
</html>
